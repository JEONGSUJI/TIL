# 왜 리액트인가? 

JavaScript만 가지고도 규모가 큰 애플리케이션을 만들 수 있는 시대가 왔다. 대규모 애플리케이션 중 프런트엔드 사이트에서 돌아가는 애플리케이션 구조를 관리하기 위해 수많은 프레임워크가 조금씩 다른 관점에서 이를 해결하기위해 노력해왔다. 이러한 프레임워크들은 MVC, MVW, MVVM 아키텍쳐를 사용한다. 



이런 여러 구조가 지닌 공통점은 모델과 뷰가 있다는 것이다. 

모델은 애플리케이션에서 사용하는 데이터를 관리하는 영역이고, 뷰는 사용자에게 보여지는 부분이다. 프로그램이 사용자에게서 어떤 작업을 받으면 컨트롤러는 모델 데이터를 조회하거나 수정하고, 변경된 사항을 뷰에 반영한다. 반영하는 과정에서 보통 뷰를 변형한다. 



만약 JSON 객체값을 사용하는 뷰가 있을 경우 객체 내부의 값이 바뀐다면 바뀐 요소를 찾아 수정해야한다.  업데이트하는 항목에 따라 어떤 부분을 찾아서 변경할지 규칙을 정하는 작업은 간단하지만, 애플리케이션 규모가 크면 상당히 복잡해지고 제대로 관리하지 않으면 성능도 떨어질 수 있다.



<u>페이스북 개발팀은 이를 해결하기 위해 데이터가 변할 때 마다 어떤 변화를 줄지 고민하는 것이 아닌 기존 뷰를 날려버리고 처음부터 새로 렌더링하는 방식을 고안해냈다.</u> 이렇게하면 애플리케이션 구조가 매우 간단하고, 작성해야 할 코드양도 많이 줄어든다. 더 이상 어떨게 변화를 줄지 신경 쓸 필요가 없고, 그저 <u>뷰가 어떻게 생길지 선언하며 데이터에 변화가 있으면 기존에 있던 것은 버리고 정해진 규칙에 따라 새로 렌더링</u>하면 되기 때문이다.

**페이스북 개발팀이 앞서 설명한 방식으로 최대한 성능을 아끼고 편안한 사용자 경험을 제공하면서 구현하고자 개발한 것이 React이다.**





## React의 이해

**리액트는 자바스크립트 라이브러리로 사용자 인터페이스를 만드는 데 사용한다.** 구조가 MVC, MVW 등인 프레임워크와 달리 **오직 V(뷰)만 신경 쓰는 라이브러리**이다.

리액트 프로젝트에서 특정 부분이 어떻게 생길지 정하는 선언체가 있는데, 이를 컴포넌트라고한다. 컴포넌트는 다른 프레임워크에서 사용자 인터페이스를 다룰 때 사용하는 템플릿과는 다른 개념이다. 컴포넌트는 재사용이 가능한 API로 수많은 기능들을 내장하고 있으며, 컴포넌트 하나에서 해당 컴포넌트의 생김새와 작동 방식을 정의한다.

사용자 화면에 뷰를 보여주는 것을 렌더링이라고 한다. 리액트 라이브러리는 뷰를 어떻게 렌더링하기에 데이터가 변할 때마다 새롭게 리렌더링하면서 성능을 아끼고, 최적의 사용자 경험을 제공할 수 있을끼? 리액트 컴포넌트가 최조로 실행한 `초기 렌더링`과 컴포넌트의 데이터 변경으로 다시 실행되는`리렌더링`개념을 이해해야한다.



### 초기 렌더링

어떤 UI 관련 프레임워크, 라이브러리를 사용하든지 간에 맨 처음 어떻게 보일지를 정하는 초기 렌더링이 필요하다. 리액트에서는 이를 다루는 **render 함수**가 있다.

```
render() {...}
```

이 함수는 <u>컴포넌트가 어떻게 생겼는지 정의하는 역할</u>을 한다. 함수는 **html 형식의 문자열을 반환하지 않고, 뷰가 어떻게 생겼고 작동하지는지에 대한 정보를 지닌 객체를 반환**한다.



컴포넌트 내부에는 또 다른 컴포넌트들이 들어갈 수 있다. 이때 render 함수를 실행하면 그 내부에 있는 컴포넌트들도 재귀적으로 렌더링한다. 이렇게 최상위 컴포넌트의 렌더링 작업이 끝나면 지니고 있는 정보들을 사용하여 html 마크업을 만들고, 우리가 정하는 실제 페이지의 DOM요소 안에 주입한다.



컴포넌트를 실제 페이지에 렌더링할 때는 분리된 두 가지 절차를 따른다. 먼저 문자열 형태의 HTML 코드를 생성한 후 특정 DOM에 해당 내용을 주입하면 이벤트가 적용된다.



### 조화 과정

리액트 라이브러리에서 중요한 부분인 업데이트를 어떻게 진행하는지 알아보자

리액트에서 뷰를 업데이트 할 때는 <u>'조화 과정(reconcilation)을 거친다</u>'라고 하는 것이 더 정확한 표현이다. 컴포넌트에서 데이터에 변화가 있을 때 우리가 보기에는 변화에 따라 뷰가 변형되는 것처럼 보이지만, 사실은 **새로운 요소로 갈아끼우기 때문**이다. 이 작업 또한 render 함수가 맡아서 한다. 

컴포넌트는 데이터를 업데이트했을 때 단순히 업데이트한 값을 수정하는 것이 아니라, 새로운 데이터를 가지고 render 함수를 또 다시 호출한다. 하지만 이때 **render함수가 반환하는 결과를 곧바로 DOM에 반영하지 않고, render 함수가 만들었던 컴포넌트 정보와 현재 render함수가 만든 컴포넌트 정보를 비교**한다. **자바스크립트를 사용하여 두 가지 뷰를 최소한의 연산으로 비교한 후, 둘의 차이를 알아내 최소한의 연산으로 DOM 트리를 업데이트 한다.** 결국 방식 자체는 루트 노드부터 시작하여 전체 컴포넌트를 처음부터 다시 렌더링하는 것처럼 보이지만, 사실 최적의 자원을 사용하여 이를 수행한다.





## React의 특징

### Virtual DOM



#### DOM이란?

Document Object Model의 약어이다. 객체로 문서 구조를 표현하는 방법으로 XML이나 HTML로 작성한다. 웹 브라우저는 DOM을 활용하여 객체에 자바스크립트와 CSS를 적용한다. DOM은 트리 형태라서 특정 노드를 찾거나 수정하거나 제거하거나 원하는 곳에 삽입할 수 있다.



#### DOM은 느릴까?

동적 UI에 최적화되어 있지 않다는 치명적인 문제가 있다. HTML은 자체적으로 정적이다. 자바스크립트를 사용해 이를 동적으로 만들 수 있다. 하지만 큰 규모의 웹 애플리케이션에서는 DOM에 직접 접근하여 변화를 주다보면 성능 이슈가 조금씩 발생하기 시작한다.  "요즘 자바스크립트 엔진은 매우 빠른 반면, DOM은 느리다"고 얘기하는데 이는 정확한 말은 아니다.

DOM 자체는 빠르다. DOM 자체를 읽고 쓸 때의 성능은 자바스크립트 객체를 처리할 때의 성능과 비교하여 다르지 않다. 단, 웹브라우저 단에서 DOM에 변화가 일어나면 웹브라우저가 CSS를 다시 연산하고, 레이아웃을 구성하고, 페이지를 리페인트한다. 이 과정에서 시간이 허비되는 것이다.

해결하기위해 DOM을 최소한으로 조작하여 작업을 처리하는 방식으로 개선할 수 있다. **리액트는 Virtual DOM 방식을 사용하여 DOM 업데이트를 추상화함으로써 DOM 처리 횟수를 최소화하고 효율적으로 진행한다.**



#### Virtual DOM

<u>virtual DOM을 사용하면 실제 DOM에 접근하여 조작하는 대신, 이를 추상화한 자바스크립트 객체를 구성하여 사용한다.</u> 마치 실제 DOM의 가벼운 사본과 비슷하다.

[리액트에서 데이터가 변하여 웹 브라우저에 실제 DOM을 업데이트 할 때 3가지 절차]

- 데이터를 업데이트하면 전체 UI를 Virtual DOM에 리렌더링한다.
- 이전 VIrtual DOM에 있던 내용과 현재 내용을 비교한다.
- 바뀐 부분만 실제 DOM에 적용한다.



#### 오해

Virtual DOM을 사용한다고 해서 사용하지 않을 때와 비교하여 무조건 빠른 것은 아니다. 리액트 메뉴얼에는 다음 문장이 있다. `지속적으로 데이터가 변화하는 대규모 애플리케이션 구축하기`의 문제를 해결하려고 리액트를 만들었다.

작업이 매우 간단할 때는 오히려 리액트를 사용하지 않는 편이 더 나은 성능을 보이기도 한다. 리액트와 Virtual DOM이 언제나 제공할 수 있는 것은 바로 업데이트 처리 간결성이다. UI를 업데이트 하는 과정에서 생기는 모든 복잡함을 모두 해소하고, 더욱 쉽게 업데이트에 접근할 수 있다.



### 기타 특징

**React는 프레임워크가 아닌 라이브러리이다**.  다른 웹 프레임워크가 Ajax, 데이터 모델링, 라우팅 등과 같은 기능을 내장하고 있는 반면, 리액트는 정말 뷰만 신경쓰는 라이브러리이므로 기타 기능은 직접 구현하여 사용해아한다.

하지만 다른 개발자들이 만든 라이브러리, 즉 라우팅에는 리액트 라우터, Ajax처리에는 axios나 fetch, 상태 관리에는 redux나 MobX를 사용하여 빈자리를 매꾸면 된다.

또 React는 다른 웹 프레임워크나 라이브러리와 혼용할 수도 있다.





## 작업 환경 설정

### Node.js와 npm

리액트 프로젝트를 만들때는 Node.js를 반드시 먼저 설치해야 한다. Node.js는 크롬 V8 자바스크립트 엔진으로 빌드한 자바스크립트 런타임이다.

리액트 애플리케이션은 웹 브라우저에서 실행되는 코드이므로 Node.js와 직접적인 연관은 없지만 프로젝트를 개발하는데 필요한 주요 도구들이 Node.js를 사용하기 때문에 설치한다. Babel(ECMAScript 호환), 웹팩(모듈화된 코드를 한 파일로 합치고 코드를 수정할 때 마다 웹 브라우저를 리로딩 하는 등의 여러 기능) 이 있다.

Node.js를 설치하면 Node.js 패키지 매니저 도구인 npm이 설치된다. npm으로 수많은 개발자가 만든 패키지를 설치하고 설치한 패키지의 버전을 관리할 수 있다.



**[macOS, Ubuntu]**

```python
$ curl -o- https:raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash
```

```python
$ nvm --version
```

```python
$ nvm install --lts
```



**[Windows]**

- Node.js 공식 사이트에서 다운로드

```python
$ node -v
```



### VS Code

- 공식 사이트에서 다운로드
- 확장 프로그램 설치 (ESLint, Reactjs Code Snippets - 제작자 charalampos 인 것, Prettier-Code formatter)
- [선택] 언어 한국어로 변경 (Korean Language Pack for V 확장 프로그램 설치)



### Git

Git은 형상 관리 도구로 프로젝트 버전을 관리하고 협업을 할 때 매우 핵심적인 역할을 한다.

- 공식 사이트에서 다운로드 (Ubuntu의 경우 `sudo apt-get install git-all`)



### create-react-app으로 프로젝트 생성

create-react-app은 리액트 프로젝트를 생성할 때 필요한 웹팩, 바벨의 설치 및 설정 과정을 생략하고 바로 간편하게 프로젝트 작업 환경을 구축해주는 도구이다.



- 프로젝트를 만들고 싶은 디렉터리에서 아래 코드를 실행한다.

```react
// yarn을 사용하는 경우
$ yarn create-react-app project-name

// npm을 사용하는 경우
$ npm init react-app project-name
```



- 프로젝트 디렉터리로 이동한 뒤 리액트 개발 전용 서버 구동

```python
$ cd project-name
$ yarn start # 또는 npm start
```



- 브라우저에서 `http://localhost:3000/` 접속





---

### Recap

- React는 페이스북 개발자들이 만든 프레임워크가 아닌 라이브러리이다. 리액트는 정말 뷰만 신경쓰는 라이브러리이므로 기타 기능은 직접 구현하여 사용해아한다.

- render함수는 뷰가 어떻게 생겼고 어떻게 작동하는지 객체를 반환한다.

- 리액트는 Virtual DOM 방식을 사용하여 DOM 업데이트를 추상화함으로써 DOM 처리 횟수를 최소화하고 효율적으로 진행한다.

- create-react-app은 리액트 프로젝트를 생성할 때 필요한 웹팩, 바벨의 설치 및 설정 과정을 생략하고 바로 간편하게 프로젝트 작업 환경을 구축해주는 도구이다.

  